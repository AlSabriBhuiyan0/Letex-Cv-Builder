#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir> <env-dir>

BUILD_DIR=$1
CACHE_DIR=$2
ENV_DIR=$3

# Install minimal TeX Live
mkdir -p $BUILD_DIR/.texlive
curl -L https://mirror.ctan.org/systems/texlive/tlnet/install-tl-unx.tar.gz | tar xz
cd install-tl-*
./install-tl --profile=/dev/null -no-gui -repository https://mirror.ctan.org/systems/texlive/tlnet/ \
    -scheme=minimal \
    -texdir $BUILD_DIR/.texlive \
    -portable -profile /dev/null

# Add TeX Live to PATH
echo "export PATH=$BUILD_DIR/.texlive/bin/x86_64-linux:\$PATH" >> $BUILD_DIR/.profile.d/texlive.sh